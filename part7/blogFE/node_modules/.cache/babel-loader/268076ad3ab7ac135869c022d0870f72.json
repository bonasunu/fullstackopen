{"ast":null,"code":"var _jsxFileName = \"/home/bona/fullstackopen/part7/blogFE/src/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport NewBlog from './components/NewBlog';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport storage from './utils/storage';\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([]);\n  const [user, setUser] = useState(null);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [notification, setNotification] = useState(null);\n  const blogFormRef = React.createRef();\n  useEffect(() => {\n    blogService.getAll().then(blogs => setBlogs(blogs));\n  }, []);\n  useEffect(() => {\n    const user = storage.loadUser();\n    setUser(user);\n  }, []);\n\n  const notifyWith = (message, type = 'success') => {\n    setNotification({\n      message,\n      type\n    });\n    setTimeout(() => {\n      setNotification(null);\n    }, 5000);\n  };\n\n  const handleLogin = async event => {\n    event.preventDefault();\n\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      });\n      setUsername('');\n      setPassword('');\n      setUser(user);\n      notifyWith(`${user.name} welcome back!`);\n      storage.saveUser(user);\n    } catch (exception) {\n      notifyWith('wrong username/password', 'error');\n    }\n  };\n\n  const createBlog = async blog => {\n    try {\n      const newBlog = await blogService.create(blog);\n      blogFormRef.current.toggleVisibility();\n      setBlogs(blogs.concat(newBlog));\n      notifyWith(`a new blog '${newBlog.title}' by ${newBlog.author} added!`);\n    } catch (exception) {\n      console.log(exception);\n    }\n  };\n\n  const handleLike = async id => {\n    const blogToLike = blogs.find(b => b.id === id);\n    const likedBlog = { ...blogToLike,\n      likes: blogToLike.likes + 1,\n      user: blogToLike.user.id\n    };\n    await blogService.update(likedBlog);\n    setBlogs(blogs.map(b => b.id === id ? { ...blogToLike,\n      likes: blogToLike.likes + 1\n    } : b));\n  };\n\n  const handleRemove = async id => {\n    const blogToRemove = blogs.find(b => b.id === id);\n    const ok = window.confirm(`Remove blog ${blogToRemove.title} by ${blogToRemove.author}`);\n\n    if (ok) {\n      await blogService.remove(id);\n      setBlogs(blogs.filter(b => b.id !== id));\n    }\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    storage.logoutUser();\n  };\n\n  if (!user) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }\n    }, \"login to application\"), /*#__PURE__*/React.createElement(Notification, {\n      notification: notification,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }\n    }, \"username\", /*#__PURE__*/React.createElement(\"input\", {\n      id: \"username\",\n      value: username,\n      onChange: ({\n        target\n      }) => setUsername(target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }\n    }, \"password\", /*#__PURE__*/React.createElement(\"input\", {\n      id: \"password\",\n      value: password,\n      onChange: ({\n        target\n      }) => setPassword(target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }\n    }, \"login\")));\n  }\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes;\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, \"blogs\"), /*#__PURE__*/React.createElement(Notification, {\n    notification: notification,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, user.name, \" logged in \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleLogout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 31\n    }\n  }, \"logout\")), /*#__PURE__*/React.createElement(Togglable, {\n    buttonLabel: \"create new blog\",\n    ref: blogFormRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(NewBlog, {\n    createBlog: createBlog,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  })), blogs.sort(byLikes).map(blog => /*#__PURE__*/React.createElement(Blog, {\n    key: blog.id,\n    blog: blog,\n    handleLike: handleLike,\n    handleRemove: handleRemove,\n    own: user.username === blog.user.username,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/bona/fullstackopen/part7/blogFE/src/App.js"],"names":["React","useState","useEffect","Blog","Notification","Togglable","NewBlog","blogService","loginService","storage","App","blogs","setBlogs","user","setUser","username","setUsername","password","setPassword","notification","setNotification","blogFormRef","createRef","getAll","then","loadUser","notifyWith","message","type","setTimeout","handleLogin","event","preventDefault","login","name","saveUser","exception","createBlog","blog","newBlog","create","current","toggleVisibility","concat","title","author","console","log","handleLike","id","blogToLike","find","b","likedBlog","likes","update","map","handleRemove","blogToRemove","ok","window","confirm","remove","filter","handleLogout","logoutUser","target","value","byLikes","b1","b2","sort"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport NewBlog from './components/NewBlog'\n\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport storage from './utils/storage'\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([])\n  const [user, setUser] = useState(null)\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [notification, setNotification] = useState(null)\n\n  const blogFormRef = React.createRef()\n\n  useEffect(() => {\n    blogService.getAll().then((blogs) => setBlogs(blogs))\n  }, [])\n\n  useEffect(() => {\n    const user = storage.loadUser()\n    setUser(user)\n  }, [])\n\n  const notifyWith = (message, type = 'success') => {\n    setNotification({\n      message,\n      type,\n    })\n    setTimeout(() => {\n      setNotification(null)\n    }, 5000)\n  }\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username,\n        password,\n      })\n\n      setUsername('')\n      setPassword('')\n      setUser(user)\n      notifyWith(`${user.name} welcome back!`)\n      storage.saveUser(user)\n    } catch (exception) {\n      notifyWith('wrong username/password', 'error')\n    }\n  }\n\n  const createBlog = async (blog) => {\n    try {\n      const newBlog = await blogService.create(blog)\n      blogFormRef.current.toggleVisibility()\n      setBlogs(blogs.concat(newBlog))\n      notifyWith(`a new blog '${newBlog.title}' by ${newBlog.author} added!`)\n    } catch (exception) {\n      console.log(exception)\n    }\n  }\n\n  const handleLike = async (id) => {\n    const blogToLike = blogs.find((b) => b.id === id)\n    const likedBlog = {\n      ...blogToLike,\n      likes: blogToLike.likes + 1,\n      user: blogToLike.user.id,\n    }\n    await blogService.update(likedBlog)\n    setBlogs(\n      blogs.map((b) =>\n        b.id === id ? { ...blogToLike, likes: blogToLike.likes + 1 } : b\n      )\n    )\n  }\n\n  const handleRemove = async (id) => {\n    const blogToRemove = blogs.find((b) => b.id === id)\n    const ok = window.confirm(\n      `Remove blog ${blogToRemove.title} by ${blogToRemove.author}`\n    )\n    if (ok) {\n      await blogService.remove(id)\n      setBlogs(blogs.filter((b) => b.id !== id))\n    }\n  }\n\n  const handleLogout = () => {\n    setUser(null)\n    storage.logoutUser()\n  }\n\n  if (!user) {\n    return (\n      <div>\n        <h2>login to application</h2>\n\n        <Notification notification={notification} />\n\n        <form onSubmit={handleLogin}>\n          <div>\n            username\n            <input\n              id=\"username\"\n              value={username}\n              onChange={({ target }) => setUsername(target.value)}\n            />\n          </div>\n          <div>\n            password\n            <input\n              id=\"password\"\n              value={password}\n              onChange={({ target }) => setPassword(target.value)}\n            />\n          </div>\n          <button id=\"login\">login</button>\n        </form>\n      </div>\n    )\n  }\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes\n\n  return (\n    <div>\n      <h2>blogs</h2>\n\n      <Notification notification={notification} />\n\n      <p>\n        {user.name} logged in <button onClick={handleLogout}>logout</button>\n      </p>\n\n      <Togglable buttonLabel=\"create new blog\" ref={blogFormRef}>\n        <NewBlog createBlog={createBlog} />\n      </Togglable>\n\n      {blogs.sort(byLikes).map((blog) => (\n        <Blog\n          key={blog.id}\n          blog={blog}\n          handleLike={handleLike}\n          handleRemove={handleRemove}\n          own={user.username === blog.user.username}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}